<div class="row">
	<div class="text-center">
		<h1>Where Should I Go For Vacation</h1>
		<h5>Checkin Date: <%= @date %></h5>
		<h6>Click on the Image For More Details</h6>
	</div>
	<div class="medium-3 large-2 columns">
		<div class="row text-center">
			<h5>Design My Trip</h5>
			<label>(Optional)</label>
	</div>
		<div class="row">
		  <label>Country Code</label>
		  <input type="text" id="country-code" placeholder="Anywhere" autofocus maxlength="3">
		</div>
		<div class="row">
		  <label>State/Province</label>
		  <input type="text" id="province" placeholder="NY" maxlength="3">
		</div>
		<div class="row">
		  <label>City</label>
		  <input type="text" id="city" placeholder="New York" >
		</div>
		<div class="row">
			<label>When You Plan on Arriving</label>
			<input type="date" id="checkin" placeholder="date">
		</div>
		<div class="row">
		  <label>Length of Stay (Days)</label>
		  <input type="number" id="days" placeholder="3">
		</div>
		<div class="row">
		  <label>Max Price</label>
		  <input type="number" id="max-price" placeholder="no max">
		</div>
		<div class="row">
			<label>Min Hotel Star Rating</label>
		  <select>
				<option name="minStarRating" value="1" id="One Star"><label for="One Star">One Star</option>
				<option name="minStarRating" value="2" id="Two Star"><label for="Two Star">Two Star</option>
				<option name="minStarRating" value="3" id="Three Star"><label for="Three Star">Three Star</option>
				<option name="minStarRating" value="4" id="Four Star"><label for="Four Star">Four Star</option>
				<option name="minStarRating" value="5" id="Five Star"><label for="Five Star">Five Star</option>
	     </select>
		</div>
		<button id="submit">filter</button>
		<%= link_to 'reset', '/', :class => 'button' %>
	</div>

	<div class="medium-9 large-10 columns">
	<% if @deals.length == 0 %>
		<h2>No Deals Found</h2>
	<% end %>
	<ul class="small-block-grid-3 medium-block-grid-4 large-block-grid-6">
	<% @deals.each do |deal| %>

		<li>
			<a href="#" class="thumb" data-reveal-id="<%= deal['hotelId'] %>"><%= image_tag(deal['imageUrl']) %></a>
			<h5><%= deal['city'] %> <%= deal['province'] %> </h5>
			<h5>For <%= deal['lengthofStay'] %> days</h5>
			<h6>Price: <%= deal['baseRate'] %></h6>
		</li>
		<div id="<%= deal['hotelId'] %>" class="reveal-modal" data-reveal>
		  <h2><%= deal['name'] %></h2>
		  <p class="lead"><%= deal['description'].html_safe %></p>
		  <p class="lead" id="country">Country: <%= deal['country'] %></p>
		  <p class="lead" id="city">City: <%= deal['city'] %> <%= deal['province'] %></p>
		  <p class="lead" id="star">Hotel Rating: <%= deal['starRating'] %></p>
		  <p class="lead">From <%= deal['checkInDate'] %> to <%= deal['checkOutDate'] %></p>
		  <p class="lead">Price Per Night: <%= deal['pricePerNight'] %></p>
		  <% if deal['originalBaseRate'] == deal['baseRate'] %>
		  	<p class="lead" id="price">Total: <%= deal['baseRate'] %></p>
		  <% else %>
		 		<p class="lead" id="price">Total: <strike><%= deal['originalBaseRate'] %></strike> <%= deal['baseRate'] %></p>
		  <% end %>
		  <p class="lead"><%= deal['promotionDescription'] %></p>
		  <%= link_to 'Book', URI.unescape(deal['dealDeepLink']), class: "button"	%>

		  <a class="close-reveal-modal">&#215;</a>
		</div>
	<% end %>
	</ul>
	</div>
</div>
<script>
  var filter = {
    getCountry: function() {
      this.country = 'country%3D' + document.getElementById("country-code").value
    },
    getStar: function() {
      this.star = 'minStarRating%3D' + $('option[name="minStarRating"]:selected').val();
    },
    getCity: function() {
      this.city = 'city%3D' + document.getElementById("city").value
    },
    getProvince: function() {
      this.province = 'province%3D' + document.getElementById("province").value
    },
    getCheck: function() {
      this.checkin = 'checkInDate%3D' + document.getElementById("checkin").value
    },
    getDays: function() {
      this.day = 'lengthofStay%3D' + document.getElementById("days").value
    },
    getPrice: function() {
      this.price = 'maxTotalRate%3D' + document.getElementById("max-price").value
    },
    setUrl: function() {
      window.location.replace('?options=' + this.country + '%26' + this.star + '%26' + this.price + '%26' + this.city + '%26' + this.day + '%26' + this.province + '%26' + this.checkin)
    },
    render: function() {
      this.getCountry()
      this.getStar()
      this.getPrice()
      this.getCity()
      this.getDays()
      this.getProvince()
      this.getCheck()
      this.setUrl()
    }
  }
  document.getElementById("submit").onclick = function(){
    filter.render();
  }
</script>
